/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * User Manual available at https://docs.gradle.org/5.4.1/userguide/java_library_plugin.html
 */

plugins {
    id 'scala'
}

repositories {
    jcenter()
}


configurations {
    gatlingtest
}


sourceSets {
    scripts {
        scala {
            srcDirs = ['gatling/scripts']
        }
        resources {
            srcDirs = ['gatling/resources']
        }
        compileClasspath += configurations.gatlingtest
        runtimeClasspath += configurations.gatlingtest
        
    }
}

dependencies {
	gatlingtest 'org.scala-lang:scala-library:2.12.0'
    gatlingtest 'io.gatling.highcharts:gatling-charts-highcharts:3.0.0'
}


task runGatlingScript(type: JavaExec) {
    description = 'Run gatling tests'
    new File("${buildDir}/reports/gatling").mkdirs()
    classpath = sourceSets.scripts.runtimeClasspath + configurations.gatlingtest
    main = "io.gatling.app.Gatling"
    args = ['-s', 'brainstorming.GetUsersScenario',
            '-sf', 'gatling/resources',
            '-df', 'gatling/resources',
            '-rf', "${buildDir}/reports/gatling"
    ]
}


task printClasspath {
    doLast {
    def classpath = sourceSets.scripts.runtimeClasspath + configurations.gatlingtests
        classpath.each { println it }
    }
}

task showConfigurations  {
    doLast {
        configurations.all { conf -> println(conf) }
    }
}